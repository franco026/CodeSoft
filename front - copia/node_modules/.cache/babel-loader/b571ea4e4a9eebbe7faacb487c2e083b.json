{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\franc\\\\Documents\\\\practicas\\\\CodeSoft2\\\\Front\\\\src\\\\App.js\";\nimport React, { Component } from 'react'; //import * as s from './App.styles';\n\nimport './App.css';\nimport NavComponent from './components/NavComponent';\nconst base_url = window.SERVER_ADDRESS;\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.display_form = formName => {\n      this.setState({\n        displayed_form: formName\n      });\n    };\n\n    this.handleLoginChange = event => {\n      this.setState({\n        [event.target.name]: event.target.value\n      });\n    };\n\n    this.handleLogout = () => {\n      localStorage.removeItem('token');\n      this.setState({\n        logged_in: false,\n        username: ''\n      });\n    };\n\n    this.handleLogin = (e, data) => {\n      e.preventDefault();\n      console.log(data);\n      fetch(base_url + 'token-auth/', {\n        crossDomain: true,\n        withCredentials: true,\n        async: true,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then(response => response.json()).then(json => {\n        localStorage.setItem('token', json.token);\n        this.setState({\n          logged_in: true,\n          username: json.user.username\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      this.setState({\n        displayed_form: ''\n      });\n    };\n\n    this.state = {\n      logged_in: localStorage.getItem('token') ? true : false,\n      username: '',\n      displayed_form: ''\n    };\n  }\n\n  componentDidMount() {\n    if (this.state.logged_in) {\n      fetch(base_url + 'users/current_user/', {\n        method: 'GET',\n        headers: {\n          Authorization: `JWT ${localStorage.getItem('token')}`\n        }\n      }).then(res => res.json()).then(resp => {\n        console.log(resp.username);\n        this.setState({\n          username: resp.username\n        });\n      }).catch(err => console.log(err));\n    }\n  }\n\n  render() {\n    const {\n      logged_in,\n      username,\n      displayed_form\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 4\n      }\n    }, /*#__PURE__*/React.createElement(NavComponent, {\n      logged_in: logged_in,\n      handleLogin: this.handleLogin,\n      handleLoginChange: this.handleLoginChange,\n      handleLogout: this.handleLogout,\n      username: username,\n      displayed_form: displayed_form,\n      display_form: this.display_form,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 5\n      }\n    }), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 5\n      }\n    }, this.state.logged_in ? `Hello ${this.state.username}` : 'Please log in'));\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["C:/Users/franc/Documents/practicas/CodeSoft2/Front/src/App.js"],"names":["React","Component","NavComponent","base_url","window","SERVER_ADDRESS","App","constructor","props","display_form","formName","setState","displayed_form","handleLoginChange","event","target","name","value","handleLogout","localStorage","removeItem","logged_in","username","handleLogin","e","data","preventDefault","console","log","fetch","crossDomain","withCredentials","async","method","headers","body","JSON","stringify","then","response","json","setItem","token","user","catch","error","state","getItem","componentDidMount","Authorization","res","resp","err","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\n//import * as s from './App.styles';\nimport './App.css';\nimport NavComponent from './components/NavComponent';\n\nconst base_url = window.SERVER_ADDRESS\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\t logged_in : localStorage.getItem('token') ? true : false,\n\t\t\t username : '',\n\t\t\t displayed_form : ''\n\t\t}\n\t}\n\n\tcomponentDidMount(){\n\t\tif(this.state.logged_in){\n\t\t\tfetch(base_url + 'users/current_user/', {\n\t\t\t\tmethod : 'GET',\n\t\t\t\theaders : {\n\t\t\t\t\tAuthorization : `JWT ${localStorage.getItem('token')}`\n\t\t\t\t}\n\t\t\t})\n\t\t\t.then(res => res.json())\n\t\t\t.then(resp => {\n        console.log(resp.username)\n\t\t\t\tthis.setState({ username : resp.username })\n\t\t\t})\n\t\t\t.catch(err => console.log(err));\n\t\t}\n\t}\n\n\tdisplay_form = (formName) => {\n        this.setState({\n            displayed_form : formName\n        });\n    }\n\n\thandleLoginChange = event => {\n        this.setState({\n            [event.target.name] : event.target.value\n        })\n\t}\n\t\n\thandleLogout = () => {\n\t\tlocalStorage.removeItem('token');\n\t\tthis.setState({logged_in : false, username : ''})\n\t}\n\n\thandleLogin = (e, data) => {\n\t\te.preventDefault();\n\t\tconsole.log(data)\n\t\tfetch(base_url + 'token-auth/', {\n\t\t\tcrossDomain : true,\n\t\t\twithCredentials : true,\n\t\t\tasync : true,\n\t\t\tmethod : 'POST',\n\t\t\theaders : {\n\t\t\t\t'Content-Type' : 'application/json',\n\t\t\t},\n\t\t\tbody : JSON.stringify(data)\n\t\t})\n\t\t.then(response => response.json())\n\t\t.then(json => {\n\t\t\tlocalStorage.setItem('token', json.token);\n\t\t\tthis.setState({\n\t\t\t\tlogged_in : true,\n\t\t\t\tusername : json.user.username\n\t\t\t})\n\t\t})\n\t\t.catch(error => {\n\t\t\tconsole.log(error)\n\t\t})\n\t\tthis.setState({\n\t\t\tdisplayed_form : ''\n\t\t})\n\t}\n\trender() {\n\t\tconst { logged_in, username, displayed_form } = this.state;\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<NavComponent\n\t\t\t\tlogged_in = {logged_in}\n\t\t\t\thandleLogin = {this.handleLogin}\n\t\t\t\thandleLoginChange = {this.handleLoginChange}\n\t\t\t\thandleLogout = {this.handleLogout}\n\t\t\t\tusername = {username}\n\t\t\t\tdisplayed_form = {displayed_form}\n\t\t\t\tdisplay_form = {this.display_form}\n\t\t\t\t />\n\t\t\t\t<h3>{\n\t\t\t\t\tthis.state.logged_in\n\t\t\t\t\t? `Hello ${this.state.username}`\n\t\t\t\t\t: 'Please log in'\n\t\t\t\t}</h3>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}